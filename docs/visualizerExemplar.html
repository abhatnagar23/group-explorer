
<!--
# Visualizer examplar

This is the pattern used to write the visualizers.  It can be run standalone from a local server with a groupURL argument
  <br>&nbsp;&nbsp;&nbsp;&nbsp;http://localhost:8080/group-explorer/docs/visualizerExample.html?groupURL=/group-explorer/groups/D_4.group<br>
It displays 
- a formatted header with the name of the group passed in the URL
- a blank graphic element
- a functional splitter element that can be used to resize the graphic and the controls panel
- a functional subgroup control panel, common to several of the visualizers
- a non-functional view control panel, with a select element and a couple of sliders
- buttons to choose between viewing the subgroup control panel and the view control panel

```html
-->
<html>
   <head>
      <meta charset="utf-8" />
      <base href=".."></base>

      <link rel="icon" type="image/png" href="./images/favicon.png"></link>
      <link rel="stylesheet" href="./style/fonts.css" type="text/css"></link>
      <link rel="stylesheet" href="./style/sliders.css" type="text/css"></link>
      <link rel="stylesheet" href="./visualizerFramework/visualizer.css" type="text/css"></style>
      <link rel="stylesheet" href="./subsetDisplay/subsets.css" type="text/css"></link>

      <style>
       #view-control {
          background: #E2E2E2;
          display: none;
       }
      </style>

      <script type="text/x-mathjax-config">
       MathJax.Hub.Config({
          CommonHTML: {
             scale: 95,   /* scale MathJax to match the HTML around it */
          },
          showMathMenu: false,   /* disable MathJax context menu (it interferes with subsetDisplay context menu) */
       });
      </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=MML_CHTML"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/jquery-resizable-dom@0.32.0/dist/jquery-resizable.js"></script>
      <script src="./build/allGroupExplorer.js"></script>
      <script src="./build/allVisualizer.js"></script>

      <script>
       /* Global variables */
       var group;  // group about which information will be displayed
       const panelNames = ['#subset-control', '#view-control'];

       /* Initial entry to javascript -- called once after document load */
       $(window).one('load', load);

       /*
        * Register static event managers -- called after document is assembled
        *    (The .off(--).on(--) sequence is used to avoid accumulating event handlers after a reset.)
        */
       function registerEventHandlers() {
          $('#subset-button').off('click', () => show('#subset-control') ).on('click', () => show('#subset-control') );
          $('#view-button').off('click', () => show('#view-control') ).on('click', () => show('#view-control') );
          $('#help').off('click', help).on('click', help);
          $('#reset').off('click', reset).on('click', reset);
          $('#organization-select').off('change', choose).on('change', choose);
          $(window).off('resize', resizeBody).on('resize', resizeBody);
       }

       /*
```
## Visualizer framework loading

Invokes [VC.load()](./visualizerFramework_js.md#vc-load-) to wrap visualizer framework layout around visualizer-specific controls
```javascript
       /* Load the static components of the page */
       function load() {
          // Promise to load group from invocation URL
          const groupLoad = Library
             .loadFromInvocation()
             .then( ({library, groupIndex}) => {
                group = library[groupIndex];
             } )
             .catch( (error) => alert('Error loading group (groupURL or similar required):\n\n' + error) );

          // Promise to load visualizer framework around visualizer-specific code in this file
          const bodyLoad = VC.load();

          // When group and framework are loaded, insert subset_page and complete rest of setup
          Promise.all([groupLoad, bodyLoad])
                 .then( () => SSD.load($('#subset-control')).then(completeSetup) )
                 .catch( (error) => alert(error) );
       }

       /* Now that all the static HTML is loaded, complete the setup */
       function completeSetup() {
          // Document is assembled, register event handlers
          registerEventHandlers();

          // Create header from group name and queue MathJax to typeset it
          $('#header').html('Visualizer Example for&nbsp;' + math(group.name));
          MathJax.Hub.Queue(['Typeset', MathJax.Hub, 'header']);

          // Create list of subgroups for select options, one choice for each proper subgroup
          for (let inx = 1; inx < group.subgroups.length - 1; inx++) {
             // Recursive routine calculates multi-character subscript as Unicode text, since option tags cannot contain HTML
             const subscript = (jnx) =>
                (jnx == 0) ? '' : (subscript(Math.floor(jnx / 10)) + subscripts[jnx % 10]);  // subscripts defined in js/mathmlUtils.js
             const subgroup = group.subgroups[inx];
             const option =  eval(Template.HTML('organization-choice-template'));
             $('#organization-select').append(option);
          }

          // Register the splitter with jquery-resizable, so you can resize the graphic horizontally
          // by grabbing the border between the graphic and the subset control and dragging it
          $('#vert-container').resizable({
             handleSelector: '#splitter',
             resizeHeight: false,
             resizeWidthFrom: 'left',
             onDrag: function () {
                // Code to resize the graphic goes here, if needed
             }
          });

          show('#subset-control');
          resizeBody();
       }

       /*
        * Resize the body, accounting for the body margins
        *    (Note that this routine would have to resize the graphic, too, if needed.)
        */
       function resizeBody() {
          $('body').height(window.innerHeight - 8);
          $('body').width(window.innerWidth - 8);
       }

       /* Show the desired panel, hide the rest */
       function show(panel_name) {
          for (const name of panelNames) {
             if (name == panel_name) {
                $(name).show();
             } else {
                $(name).hide();
             }
          }
       }

       /* Example event handler, set up in registerCallback */
       function choose(ev) {
          alert(`subgroup ${ev.target.value} selected`);
       }

       /* Routines for Help, Reset buttons at bottom of control panel */
       function help() {
          alert('This is a simple example to show how visualizers are built.');
       }

       /*
```
## Visualizer framework reset

Uses [VC.restore()](./visualizerFramework_js.md#vs-restore-) to recover visualizer-specific layout
```javascript
       */
       function reset() {
          VC.reset();
          load();
       }
      </script>
   </head>
<!--
```
## Visualizer-specific HTML

The body contains the visualizer-specific HTML to lay out the controls for this visualizer.  This HTML will be wrapped in the visualizer framework by [VC.load()](./visualizerFramework_js.md#vc-load-), called during [initialization](#visualizer-framework-loading).
```html
-->
   <body class="vert">
      <div id="control-options" class="horiz">
         <button id="subset-button">Subsets</button>
         <button id="view-button">View</button>
      </div>

      <div id="subset-control" class="fill-vert">
         <!-- This is filled in by subsetDisplay/subsets.html -->
      </div>

      <div id="view-control" class="fill-vert">
         <p>Organize by subgroup:</p>
         <select id="organization-select" class="select">
            <option value="0">none</option>
         </select>
         <template id="organization-choice-template">
            <option value="${inx}">H${subscript(inx)}, a subgroup of order ${subgroup.order}</option>
         </template>

         <p>Zoom level:</p>
         <input id="zoom-level" type="range" min="-10" max="10" value="0">

         <p>Line thickness:</p>
         <input id="line-thickness" type="range" min="1" max="20" value="10">
      </div>
   </body>
</html>
<!--
```
-->
